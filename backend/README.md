# MedMentor.AI Backend

NestJS backend for MedMentor.AI - AI-Driven Medication Adherence & Risk Alert System.

## Setup

1. Install dependencies:
```bash
npm install
```

2. Set up environment variables (create `.env` file):
```bash
# Backend Configuration
PORT=3000

# AI Service URL
AI_SERVICE_URL=http://localhost:8000

# PostgreSQL Database
DATABASE_URL=postgresql://admin:merai4546@10.11.7.65:5433/medmentor

# Environment
NODE_ENV=development
```

3. Ensure PostgreSQL database is accessible and the database `medmentor` exists.

4. Run the application:
```bash
# Development
npm run start:dev

# Production
npm run build
npm run start:prod
```

## Database

The application uses PostgreSQL with TypeORM. Tables are automatically created on startup in development mode (`synchronize: true`).

### Entities

- **patients** - Patient information
- **doctors** - Doctor information  
- **medication_doses** - Medication dose history (taken/skipped)
- **alerts** - Risk alerts generated by AI
- **messages** - Doctor-patient communication

## API Endpoints

See Swagger documentation at: `http://localhost:3000/api`

### Main Endpoints

- `GET /patient` - Get all patients
- `GET /patient/:id` - Get patient by ID
- `POST /patient/skip-dose` - Record skipped dose
- `POST /patient/record-dose` - Record dose (taken/skipped)
- `GET /patient/:id/medication-history` - Get medication history
- `GET /doctor/dashboard/:doctorId` - Get doctor dashboard with all patient details
- `GET /alerts/stream` - SSE stream for real-time alerts
- `POST /messages` - Send message
- `POST /messages/voice` - Send voice message (WAV file)

## Architecture

- **NestJS** with Fastify adapter
- **TypeORM** for PostgreSQL
- **EventEmitter** for real-time alerts (SSE)
- **Swagger** for API documentation
